

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.jpg">
  <link rel="icon" href="/img/favicon.jpg">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="课程实验2 datalab">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
  <title>lab2_datalab - Zino&#39;s Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      
        
          
          
          
        
        <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.min.css" />
      
      
        <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.css" />
      
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"zino00.github.io","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":70,"cursorChar":"","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":1},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":"f45dcd001d67e8f9d84f91248ea31abf","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Zino's Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/post.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="lab2_datalab">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-07-04 13:03" pubdate>
        2021年7月4日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      2.6k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      40
       分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">lab2_datalab</h1>
            
            <div class="markdown-body">
              <h1 id="lab2_datalab"><a class="markdownIt-Anchor" href="#lab2_datalab"></a> lab2_datalab</h1>
<h2 id="1bitand"><a class="markdownIt-Anchor" href="#1bitand"></a> 1.bitAnd</h2>
<p>这个很简单</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 

 * bitAnd - x&amp;y using only ~ and | 
 *   Example: bitAnd(6, 5) &#x3D; 4
 *   Legal ops: ~ |
 *   Max ops: 8
 *   Rating: 1
 *&#x2F;
int bitAnd(int x, int y) &#123;

  	return ~(~x|~y);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="2getbyte"><a class="markdownIt-Anchor" href="#2getbyte"></a> 2.getByte</h2>
<p>舍掉最后的n个字节，即n*8位，并保留舍掉后的最后8位</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 

 * getByte - Extract byte n from word x

 * Bytes numbered from 0 (LSB) to 3 (MSB)

 * Examples: getByte(0x12345678,1) &#x3D; 0x56

 * Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;

 * Max ops: 6

 * Rating: 2
    *&#x2F;
   int getByte(int x, int n) &#123;
   int tmp &#x3D;x&gt;&gt;(n&lt;&lt;3);&#x2F;&#x2F;将目标移到最后
   tmp&#x3D;tmp&amp;0xFF;&#x2F;&#x2F;保留目标
   return tmp;
   &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="3logicalshift"><a class="markdownIt-Anchor" href="#3logicalshift"></a> 3.logicalShift</h2>
<p>对x进行逻辑右移（算术右移补符号位，逻辑右移补0），可以采用先进行算术右移，然后将右移多出来的符号位置0。</p>
<p>因为不能使用减号，所以将1左移31位后采用先右移n,再左移1位的方法，最后取反。</p>
<p>与算术右移进行与即可得到结果</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 
 * logicalShift - shift x to the right by n, using a logical shift
 *   Can assume that 0 &lt;&#x3D; n &lt;&#x3D; 31
 *   Examples: logicalShift(0x87654321,4) &#x3D; 0x08765432
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 20
 *   Rating: 3 
 *&#x2F;
int logicalShift(int x, int n) &#123;
	int result &#x3D; (x &gt;&gt; n) &amp; (~(((1 &lt;&lt; 31) &gt;&gt; n) &lt;&lt; 1));

  	return result;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="4bitcount"><a class="markdownIt-Anchor" href="#4bitcount"></a> 4.bitCount</h2>
<p>此问题较为复杂，参考了网上的做法，采用自底向上的方式进行求解，先求两位中1的个数、再求四位中1的个数……最后求三十二位中1的个数</p>
<p>具体过程如图所示:</p>
<p><img src="/posts/330a79db/image-20210406160622289.png" srcset="/img/loading.gif" lazyload alt></p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;*
 * bitCount - returns count of number of 1&#39;s in word
 *   Examples: bitCount(5) &#x3D; 2, bitCount(7) &#x3D; 3
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 40
 *   Rating: 4
 *&#x2F;
int bitCount(int x) &#123;
	int mask_1,mask_2,mask_4,mask_8,mask_16;

  	mask_1&#x3D;0x55|(0x55&lt;&lt;8);
  	mask_1&#x3D;mask_1|(mask_1&lt;&lt;16);&#x2F;&#x2F;计算得到0x55555555,即01010101···
  	mask_2&#x3D;0x33|(0x33&lt;&lt;8);
  	mask_2&#x3D;mask_2|(mask_2&lt;&lt;16);&#x2F;&#x2F;计算得到0x33333333,即00110011···
  	mask_4&#x3D;0x0f|(0x0f&lt;&lt;8);
  	mask_4&#x3D;mask_4|(mask_4&lt;&lt;16);&#x2F;&#x2F;计算得到0x0f0f0f0f,即00001111···
  	mask_8&#x3D;0xff|(0xff&lt;&lt;16);&#x2F;&#x2F;0000000011111111 0000000011111111
  	mask_16&#x3D;0xff|(0xff&lt;&lt;8);&#x2F;&#x2F;00000000000000001111111111111111
  	x&#x3D;(x&amp;mask_1)+((x&gt;&gt;1)&amp;mask_1);
  	x&#x3D;(x&amp;mask_2)+((x&gt;&gt;2)&amp;mask_2);
  	&#x2F;&#x2F;下面三组最高位不会是1了 
  	x&#x3D;(x+(x&gt;&gt;4))&amp;mask_4;&#x2F;&#x2F;x&#x3D;(x&amp;mask_4)+((x&gt;&gt;4)&amp;mask_4);
  	x&#x3D;(x+(x&gt;&gt;8))&amp;mask_8;&#x2F;&#x2F;x&#x3D;(x&amp;mask_8)+((x&gt;&gt;8)&amp;mask_8);
  	x&#x3D;(x+(x&gt;&gt;16))&amp;mask_16;&#x2F;&#x2F;x&#x3D;(x&amp;mask_16)+((x&gt;&gt;16)&amp;mask_16);
  	return x;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="5bang"><a class="markdownIt-Anchor" href="#5bang"></a> 5.bang</h2>
<p>不利用逻辑符号!求一个数的逻辑非，也就是判断该数的二进制位<strong>是否全为0</strong>，若全为0则返回1，否则返回0。</p>
<p>一个<strong>求补码</strong>的方法：<strong>从最低位到第一个1之间不变，其他位按位取反</strong>。</p>
<p>一个数与其补码相或后，只有0x00000000的结果最高位是0，其他数结果都是1，所以我们将原数与其补码相或后右移31位得到最高位，将最高位与1相与，结果为0说明原数是0，取反后输出1，否则说明原数不为0，取反后输出0。</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 

 * bang - Compute !x without using !
 *   Examples: bang(3) &#x3D; 0, bang(0) &#x3D; 1
 *   Legal ops: ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 12
 *   Rating: 4 
 *&#x2F;
int bang(int x) &#123;

 	return ~((x|(~x+1))&gt;&gt;31)&amp;1;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="6tmin"><a class="markdownIt-Anchor" href="#6tmin"></a> 6.tmin</h2>
<p>返回 最小的二进制补码，为0x 8000 0000，直接左移31位即可</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 
 * tmin - return minimum two&#39;s complement integer 
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 4
 *   Rating: 1
 *&#x2F;
int tmin(void) &#123;
	return 1&lt;&lt;31;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="7fitsbits"><a class="markdownIt-Anchor" href="#7fitsbits"></a> 7.fitsBits</h2>
<p>判断一个数能否表示成n位的二进制，能则返回1，不能返回0</p>
<p>关键在于这个n位是包括符号位的，即对于一个整数，其最高位应为0，对于一个负数，最高位为1</p>
<p>先左移32-n 再右移32-n,考虑符号位，若与x相等则说明可以。</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 
 * fitsBits - return 1 if x can be represented as an 
 * n-bit, two&#39;s complement integer.
 * 1 &lt;&#x3D; n &lt;&#x3D; 32
 * Examples: fitsBits(5,3) &#x3D; 0, fitsBits(-4,3) &#x3D; 1
 * Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 * Max ops: 15
 * Rating: 2
    *&#x2F;
   int fitsBits(int x, int n) &#123;
   int shiftNumber&#x3D; 32 + (~n + 1);&#x2F;&#x2F; 32 - n
   return !(x^((x&lt;&lt;shiftNumber)&gt;&gt;shiftNumber));
   &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="8divpwr2"><a class="markdownIt-Anchor" href="#8divpwr2"></a> 8.divpwr2</h2>
<p>将一个数除以2的n次方</p>
<p>除法是向下取整，正数位运算和除法运算相同，负数除法向0取整，位运算向下取整，<br>
所以要靠位运算来实现负数除法就要加一个偏置量，使其变成比原来的数小2^n个单位的数<br>
使得新数通过位运算的向下取整和原数的向0取整结果相同</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 
 * divpwr2 - Compute x&#x2F;(2^n), for 0 &lt;&#x3D; n &lt;&#x3D; 30
 *  Round toward zero
 *   Examples: divpwr2(15,1) &#x3D; 7, divpwr2(-33,4) &#x3D; -2
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 15
 *   Rating: 2

 *&#x2F;
int divpwr2(int x, int n) &#123;
	int signx&#x3D;x&gt;&gt;31;
	int mask &#x3D;(1&lt;&lt;n)+(~0);
	int bias&#x3D;signx&amp;mask;
    return (bias+x)&gt;&gt;n;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="9negate"><a class="markdownIt-Anchor" href="#9negate"></a> 9.negate</h2>
<p>返回-x，很简单</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 
 * negate - return -x 
 *   Example: negate(1) &#x3D; -1.
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 5
 *   Rating: 2
 *&#x2F;
int negate(int x) &#123;
    return ~x+1;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="10ispositive"><a class="markdownIt-Anchor" href="#10ispositive"></a> 10.isPositive</h2>
<p>正数符号位为0，负数符号位为，0的符号位也是0。</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 
 * isPositive - return 1 if x &gt; 0, return 0 otherwise 
 *   Example: isPositive(-1) &#x3D; 0.
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 8
 *   Rating: 3
 *&#x2F;
int isPositive(int x) &#123;
    return !(x&gt;&gt;31|!x);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="11islessorequal"><a class="markdownIt-Anchor" href="#11islessorequal"></a> 11.isLessOrEqual</h2>
<p>这道题相当于枚举 x&lt;=y 的所有情况：<br>
1.x为负数，y 为正数<br>
2.x 等于 y<br>
3.x 和 y 符号相同，并且 y-x 为正数</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 
 * isLessOrEqual - if x &lt;&#x3D; y  then return 1, else return 0 
 *   Example: isLessOrEqual(4,5) &#x3D; 1.
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 24
 *   Rating: 3
 *&#x2F;
int isLessOrEqual(int x, int y) &#123;
	int signx &#x3D; (x&gt;&gt;31) &amp; 0x1;
	int signy &#x3D; (y&gt;&gt;31) &amp; 0x1;
	int tmp &#x3D; signx ^ signy;
	int tmp1 &#x3D; tmp &amp; signx;&#x2F;&#x2F;为1时表示x为负数，y为正数
	int y_x&#x3D;y+(~x+1);
    return tmp1|(!(x^y))|(!tmp&amp;!(y_x&amp;(1&lt;&lt;31)));
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="12ilog2"><a class="markdownIt-Anchor" href="#12ilog2"></a> 12.ilog2</h2>
<p>求一个数是2的几次幂，即求最高位的1的索引（0-31）</p>
<p>也是二分，先去掉后16位，先判断左边16位，若全是0，则!!(x&gt;&gt;16)返回0，否则返回1,1&lt;&lt;4则记录左边16位的最低位索引</p>
<p>若前16位中含1，则只保留了前16位，否则前16的0可以忽略，相当于考虑后16位</p>
<p>之后同理，将16位二分，然后记录索引。</p>
<p>全部索引相加就是结果</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;*
 * ilog2 - return floor(log base 2 of x), where x &gt; 0
 *   Example: ilog2(16) &#x3D; 4
 *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
 *   Max ops: 90
 *   Rating: 4
 *&#x2F;
int ilog2(int x) &#123;
	int bitsNumber &#x3D; 0;
	bitsNumber &#x3D; (!!(x &gt;&gt; 16)) &lt;&lt; 4;&#x2F;&#x2F;去掉后16位，判断左边16位是否全为0，不是则记录左边16位的最低位索引
	bitsNumber +&#x3D; (!!(x &gt;&gt; (bitsNumber + 8)) &lt;&lt; 3);&#x2F;&#x2F;判断左边16位是否全为0，不是则记录左边位8的最低位索引
	bitsNumber +&#x3D; (!!(x &gt;&gt; (bitsNumber + 4)) &lt;&lt; 2);&#x2F;&#x2F;
	bitsNumber +&#x3D; (!!(x &gt;&gt; (bitsNumber + 2)) &lt;&lt; 1);&#x2F;&#x2F;
	bitsNumber +&#x3D; (!!(x &gt;&gt; (bitsNumber + 1)));&#x2F;&#x2F;
	return bitsNumber;

&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="13float_neg"><a class="markdownIt-Anchor" href="#13float_neg"></a> 13.float_neg</h2>
<p>返回一个无符号浮点数的负的单精度浮点数表达，参数NaN（阶码全为1，小数域非0）时返回原值</p>
<p>关键在于NaN的判断，其他参数加上一个符号位即可；</p>
<p>((uf&gt;&gt;23)&amp;0xff)^0xff判断阶码是否全为1，是的话结果为0，!(uf&amp;((1&lt;&lt;23)-1))判断小数域是否全为0，是的话为1</p>
<p>所以代码含义就是：</p>
<p>if(不是NaN)加符号位</p>
<p>否则返回原参数</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 
 * float_neg - Return bit-level equivalent of expression -f for
 *   floating point argument f.
 *   Both the argument and result are passed as unsigned int&#39;s, but
 *   they are to be interpreted as the bit-level representations of
 *   single-precision floating point values.
 *   When argument is NaN, return argument.
 *   Legal ops: Any integer&#x2F;unsigned operations incl. ||, &amp;&amp;. also if, while
 *   Max ops: 10
 *   Rating: 2
 *&#x2F;
unsigned float_neg(unsigned uf) &#123;
	if((((uf&gt;&gt;23)&amp;0xff)^0xff)||!(uf&amp;((1&lt;&lt;23)-1))) uf&#x3D;(1&lt;&lt;31)^uf;

  	return uf;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="14float_i2f"><a class="markdownIt-Anchor" href="#14float_i2f"></a> 14.float_i2f</h2>
<p>将一个int型数转化为浮点型。</p>
<p>问题重点在于考虑浮点数的舍入</p>
<ul>
<li>
<p>浮点数舍入规则</p>
<p>如果以形式1.RR…RDD…D表示浮点数（R表示有效位，或保留位，而D表示舍去位），舍入规则就是：</p>
<p>如果DD…D &lt; 10…0，则向下舍入</p>
<p>如果DD…D &gt; 10…0，则向上舍入</p>
<p>如要DD…D = 10…0，则向最近偶数舍入，细则如下 ：</p>
<p>a. 如果RR…R = XX…0 （最低有效位是0），则向下舍入</p>
<p>b. 如果RR…R = XX…1（最低有效位是1），则向上舍入</p>
</li>
</ul>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 
 * float_i2f - Return bit-level equivalent of expression (float) x
 *   Result is returned as unsigned int, but
 *   it is to be interpreted as the bit-level representation of a
 *   single-precision floating point values.
 *   Legal ops: Any integer&#x2F;unsigned operations incl. ||, &amp;&amp;. also if, while
 *   Max ops: 30
 *   Rating: 4
 *&#x2F;
unsigned float_i2f(int x) &#123;
	    unsigned shiftLeft&#x3D;0;
	    unsigned afterShift, tmp, flag;
	    unsigned absX&#x3D;x;
	    unsigned sign&#x3D;0;
	    &#x2F;&#x2F;special case
	    if (x&#x3D;&#x3D;0) return 0;
	    &#x2F;&#x2F;if x &lt; 0, sign &#x3D; 1000...,abs_x &#x3D; -x
	    if (x&lt;0)&#x2F;&#x2F;小于0，则取反
	    &#123;
		sign&#x3D;0x80000000;
		absX&#x3D;-x;
	    &#125;
	    afterShift&#x3D;absX;
	    &#x2F;&#x2F;count shift_left and after_shift
	    while (1)&#x2F;&#x2F;计算阶码E&#x3D;32-shiftLeft，aftershift保留尾数的值
	    &#123;
		tmp&#x3D;afterShift;
		afterShift&lt;&lt;&#x3D;1;
		shiftLeft++;
		if (tmp &amp; 0x80000000) break;
	    &#125;
	    &#x2F;&#x2F;afterShift的前23位保留作为尾数，要考虑舍入
	    if ((afterShift &amp; 0x01ff)&gt;0x0100)&#x2F;&#x2F;进位
		flag&#x3D;1;
	    else if ((afterShift &amp; 0x03ff)&#x3D;&#x3D;0x0300)&#x2F;&#x2F;向偶数舍入
		flag&#x3D;1;
	    else
		flag&#x3D;0;
	
	    return sign +((127+32-shiftLeft)&lt;&lt;23) +(afterShift&gt;&gt;9) + flag;
	    &#x2F;&#x2F;符号位+阶码+尾数+舍入值
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="15float_twice"><a class="markdownIt-Anchor" href="#15float_twice"></a> 15.float_twice</h2>
<p>返回一个无符号浮点数的两倍</p>
<p>对于非规格化数，尾数左移1位就相当于乘2</p>
<p>对于规格化数，阶码加一即可</p>
<p>对于NaN，返回原值</p>
<div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;* 
 * float_twice - Return bit-level equivalent of expression 2*f for
 *   floating point argument f.
 *   Both the argument and result are passed as unsigned int&#39;s, but
 *   they are to be interpreted as the bit-level representation of
 *   single-precision floating point values.
 *   When argument is NaN, return argument
 *   Legal ops: Any integer&#x2F;unsigned operations incl. ||, &amp;&amp;. also if, while
 *   Max ops: 30
 *   Rating: 4
 *&#x2F;

unsigned float_twice(unsigned uf) &#123;
	if((uf&amp;0x7f800000)&#x3D;&#x3D;0)  &#x2F;&#x2F;阶码为0，非规格化数
		uf&#x3D;((uf&amp;0x007fffff)&lt;&lt;1)|(uf&amp;0x80000000);&#x2F;&#x2F;尾数域左移一位，别忘了符号
	else if((uf&amp;0x7f800000)!&#x3D;0x7f800000) &#x2F;&#x2F;不是NaN ，阶码不是全1 
		uf&#x3D;uf+0x800000;&#x2F;&#x2F;阶码+1，2^(1+1)&#x3D;2*2  
  	return uf;

&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>
<h2 id="测试结果截图"><a class="markdownIt-Anchor" href="#测试结果截图"></a> 测试结果截图</h2>
<p><img src="/posts/330a79db/image-20210407110327739.png" srcset="/img/loading.gif" lazyload alt="image-20210407110327739"></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/">计算机系统</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/">计算机系统</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，著作权归作者所有，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/posts/2ee63cf/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">lab3_bomblab</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    
      <script type="text/javascript">
        var disqus_config = function() {
          this.page.url = 'https://zino00.github.io/posts/330a79db/';
          this.page.identifier = '/posts/330a79db/';
        };
        Fluid.utils.loadComments('#disqus_thread', function() {
          var d = document, s = d.createElement('script');
          s.src = '//' + 'fluid' + '.disqus.com/embed.js';
          s.setAttribute('data-timestamp', new Date());
          (d.head || d.body).appendChild(s);
        });
      </script>
    
    <noscript>Please enable JavaScript to view the comments</noscript>
  </div>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a  rel="nofollow noopener"><span>Copyrights © 2021</span></a> <i class="iconfont icon-love"></i> <a  target="_blank" rel="nofollow noopener"><span>Zino</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d1745c2e21adaa6ae90b93f4f4d22da9";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  
    
  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>





  

  
    <!-- KaTeX -->
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.10/dist/katex.min.css" />
  








  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?f45dcd001d67e8f9d84f91248ea31abf";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  

  

  

  

  





<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
